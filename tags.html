---
layout: page
title: Tags
---
{%- comment -%}
    Combined tag index for blog posts and photo collection items.
    We cannot rely solely on site.tags because it excludes custom collections like `photos`.
{%- endcomment -%}

{%- assign all_docs = site.posts | concat: site.photos -%}
{%- assign tag_names = "" | split: "" -%}
{%- for doc in all_docs -%}
    {%- if doc.tags -%}
        {%- for t in doc.tags -%}
            {%- assign tag_names = tag_names | push: t -%}
        {%- endfor -%}
    {%- endif -%}
{%- endfor -%}
{%- assign unique_tags = tag_names | uniq | sort_natural -%}

<section class="list">
    <h1 class="title">Tags</h1>
    {%- for t in unique_tags -%}
        {%- assign t_slug = t | slugify -%}
        {%- comment -%} Count docs for tag {%- endcomment -%}
        {%- assign tagged_docs = all_docs | where_exp: "d","d.tags contains t" -%}
        <a class="item" href="#{{ t_slug }}">{{ t }}<span class="tag-count">{{ tagged_docs.size }}</span></a>
    {%- endfor -%}
</section>

<hr>

<section class="tag-list">
    {%- for t in unique_tags -%}
        {%- assign t_slug = t | slugify -%}
        {%- assign tagged_docs = all_docs | where_exp: "d","d.tags contains t" | sort: "date" | reverse -%}
        <h2 class="title" id="{{ t_slug }}">#{{ t }}</h2>
        <ul class="list">
                    {%- for doc in tagged_docs -%}
                        {%- assign thumb = nil -%}
                        {%- if doc.collection == "photos" -%}
                            {%- if doc.images and doc.images.size > 0 -%}
                                {%- assign thumb = doc.images[0] -%}
                            {%- elsif doc.image -%}
                                {%- assign thumb = doc.image -%}
                            {%- endif -%}
                        {%- endif -%}
                        <li class="item tag-doc">
                            <a class="url" href="{{ site.url }}{{ doc.url }}">
                                <aside class="date">
                                    {%- if doc.date -%}
                                        <time datetime="{{ doc.date | date: "%Y-%m-%d" }}">{{ doc.date | date: "%b %d %Y" }}</time>
                                    {%- endif -%}
                                </aside>
                                {%- if thumb -%}
                                    <span class="thumb-wrapper"><img src="{{ thumb | relative_url }}" alt="{{ doc.title }} thumbnail" loading="lazy" /></span>
                                {%- endif -%}
                                <h3 class="title">{{ doc.title }}</h3>
                            </a>
                        </li>
                    {%- endfor -%}
        </ul>
        <div class="breaker"></div>
    {%- endfor -%}
</section>

<style>
/* Tag count bubble */
.tag-count { background:#f2f2f2; border-radius:10px; padding:2px 6px; font-size:0.65rem; margin-left:4px; }
.tag-list .tag-doc { display:flex; align-items:center; }
.tag-list .tag-doc .url { display:flex; align-items:center; gap:.5rem; width:100%; }
.tag-list .tag-doc .thumb-wrapper { width:48px; height:48px; flex:0 0 48px; overflow:hidden; border-radius:4px; background:#f5f5f5; display:inline-block; }
.tag-list .tag-doc .thumb-wrapper img { width:100%; height:100%; object-fit:cover; display:block; }
.tag-list .tag-doc h3.title { margin:0; font-size:1rem; }
.tag-list .tag-doc aside.date { min-width:85px; }
@media (max-width:600px){
    .tag-list .tag-doc aside.date { display:none; }
}
</style>
