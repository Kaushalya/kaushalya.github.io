---
layout: page
title: Tags
---
{%- comment -%}
    Combined tag index for blog posts and photo collection items.
    We cannot rely solely on site.tags because it excludes custom collections like `photos`.
{%- endcomment -%}

{%- assign all_docs = site.posts | concat: site.photos -%}
{%- assign tag_names = "" | split: "" -%}
{%- for doc in all_docs -%}
    {%- if doc.tags -%}
        {%- for t in doc.tags -%}
            {%- assign tag_names = tag_names | push: t -%}
        {%- endfor -%}
    {%- endif -%}
{%- endfor -%}
{%- assign unique_tags = tag_names | uniq | sort_natural -%}

<section class="list">
    <h1 class="title">Tags</h1>
    {%- for t in unique_tags -%}
        {%- assign t_slug = t | slugify -%}
        {%- comment -%} Count docs for tag {%- endcomment -%}
        {%- assign tagged_docs = all_docs | where_exp: "d","d.tags contains t" -%}
        <a class="item" href="#{{ t_slug }}">{{ t }}<span class="tag-count">{{ tagged_docs.size }}</span></a>
    {%- endfor -%}
</section>

<hr>

<section class="tag-list">
    {%- for t in unique_tags -%}
        {%- assign t_slug = t | slugify -%}
        {%- assign tagged_docs = all_docs | where_exp: "d","d.tags contains t" | sort: "date" | reverse -%}
        <h2 class="title" id="{{ t_slug }}">#{{ t }}</h2>
        <ul class="list">
            {%- for doc in tagged_docs -%}
                <li class="item">
                    <a class="url" href="{{ site.url }}{{ doc.url }}">
                        <aside class="date">
                            {%- if doc.date -%}
                                <time datetime="{{ doc.date | date: "%Y-%m-%d" }}">{{ doc.date | date: "%b %d %Y" }}</time>
                            {%- endif -%}
                            {%- if doc.collection == "photos" -%}<span class="badge">ðŸ“·</span>{%- endif -%}
                        </aside>
                        <h3 class="title">{{ doc.title }}</h3>
                    </a>
                </li>
            {%- endfor -%}
        </ul>
        <div class="breaker"></div>
    {%- endfor -%}
</section>

<style>
/* Tag count bubble */
.tag-count { background:#f2f2f2; border-radius:10px; padding:2px 6px; font-size:0.65rem; margin-left:4px; }
.tag-list .badge { margin-left:4px; }
</style>
